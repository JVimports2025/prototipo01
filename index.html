<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JV Imports | Premium Store</title>
    
    <!-- Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- PagBank SDK -->
    <script src="https://assets.pagseguro.com.br/checkout-sdk-js/rc/dist/browser/pagseguro.min.js"></script>

    <style>
        :root {
            /* --- LIGHT MODE DEFINITIONS --- */
            --primary: #000000;
            --on-primary: #ffffff;
            --secondary: #f3f4f6;      /* Slightly darker gray for better definition */
            --bg-body: #f9fafb;        /* Off-white body */
            --surface: #ffffff;        /* Pure white cards */
            --border: #e5e7eb;         /* Defined border gray */
            --text-main: #111827;      /* Near black */
            --text-light: #6b7280;
            --accent-error: #ef4444;
            --accent-success: #10b981;
            
            /* Visuals */
            --radius: 12px;
            --header-height: 72px;
            --nav-height: 65px;
            --max-width: 1200px;
            
            /* Shadows for Light Mode Depth */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        [data-theme="dark"] {
            /* --- DARK MODE DEFINITIONS --- */
            --primary: #ffffff;
            --on-primary: #000000;
            --secondary: #27272a;
            --bg-body: #09090b;
            --surface: #18181b;
            --border: #3f3f46;
            --text-main: #f3f4f6;
            --text-light: #a1a1aa;
            
            /* Dark mode usually relies less on shadows and more on borders/bg distinction */
            --shadow-sm: none;
            --shadow-md: none; 
            --shadow-lg: none;
        }

        /* Base Reset */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: var(--bg-body); color: var(--text-main); 
            min-height: 100vh; display: flex; flex-direction: column;
            line-height: 1.5;
        }
        a { text-decoration: none; color: inherit; }
        button { cursor: pointer; font-family: inherit; }

        /* --- LAYOUT --- */
        .container {
            width: 100%; max-width: var(--max-width);
            margin: 0 auto; padding: 0 24px;
        }

        #main-content {
            flex: 1;
            padding-top: 30px;
            padding-bottom: 80px; /* Space for mobile nav */
        }
        @media (min-width: 768px) {
            #main-content { padding-bottom: 60px; }
        }

        /* --- HEADER --- */
        header {
            height: var(--header-height);
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 100;
            box-shadow: var(--shadow-sm);
        }
        .header-inner {
            height: 100%; display: flex; align-items: center; justify-content: space-between;
        }
        .logo-img { height: 42px; width: auto; display: block; }
        [data-theme="light"] .logo-img { mix-blend-mode: multiply; }
        [data-theme="dark"] .logo-img { filter: invert(1); mix-blend-mode: screen; }

        /* Desktop Nav */
        .desktop-nav { display: none; gap: 32px; font-weight: 500; font-size: 0.95rem; }
        .desktop-nav a { color: var(--text-light); transition: color 0.2s; }
        .desktop-nav a:hover, .desktop-nav a.active { color: var(--text-main); font-weight: 600; }
        @media (min-width: 768px) { .desktop-nav { display: flex; } }

        /* --- CARDS & CONTAINERS --- */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        /* Definition for Light Mode */
        [data-theme="light"] .card {
            box-shadow: var(--shadow-sm);
        }
        [data-theme="light"] .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
            border-color: #d1d5db; /* Slightly darker border on hover */
        }

        /* --- PRODUCT GRID --- */
        .product-grid {
            display: grid; gap: 24px;
            grid-template-columns: repeat(2, 1fr);
        }
        @media (min-width: 768px) { .product-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (min-width: 1024px) { .product-grid { grid-template-columns: repeat(4, 1fr); } }

        .card-img-wrapper {
            position: relative; padding-top: 100%; /* 1:1 Aspect Ratio */
            background: var(--secondary); overflow: hidden;
        }
        .card-img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; transition: transform 0.3s;
            mix-blend-mode: multiply;
        }
        [data-theme="dark"] .card-img { mix-blend-mode: normal; opacity: 0.9; }
        .card:hover .card-img { transform: scale(1.05); }

        .card-body { padding: 16px; display: flex; flex-direction: column; gap: 8px; }
        
        /* --- BUTTONS --- */
        .btn {
            background: var(--primary); color: var(--on-primary);
            padding: 12px 20px; border-radius: 8px; font-weight: 600;
            border: 2px solid transparent; 
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
            transition: all 0.2s; font-size: 0.95rem;
            box-shadow: var(--shadow-sm);
        }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); box-shadow: var(--shadow-md); }
        .btn:active { transform: translateY(0); }
        
        .btn-outline {
            background: transparent; color: var(--text-main);
            border: 2px solid var(--border); box-shadow: none;
        }
        .btn-outline:hover {
            border-color: var(--text-main); background: var(--surface);
        }
        
        .btn-sm { padding: 8px 14px; font-size: 0.85rem; }

        /* --- INPUTS --- */
        .form-input {
            width: 100%; padding: 12px 16px; 
            border: 1px solid var(--border);
            border-radius: 8px; font-size: 0.95rem; 
            background: var(--surface); color: var(--text-main); 
            outline: none; transition: border-color 0.2s;
        }
        /* High contrast focus for inputs */
        .form-input:focus { border-color: var(--primary); ring: 2px solid var(--primary); }
        .form-label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.85rem; color: var(--text-light); text-transform: uppercase; letter-spacing: 0.5px; }

        /* --- CHECKOUT LAYOUT --- */
        .checkout-layout {
            display: grid; gap: 30px;
            grid-template-columns: 1fr;
        }
        @media(min-width: 900px) {
            .checkout-layout { grid-template-columns: 1.8fr 1.2fr; align-items: start; }
        }

        /* --- FOOTER --- */
        footer {
            background: var(--surface); border-top: 1px solid var(--border);
            padding: 60px 0 30px; margin-top: auto;
        }
        .footer-links {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px; margin-bottom: 40px;
        }
        .footer-links h4 { font-weight: 700; margin-bottom: 20px; font-size: 1rem; }
        .footer-links ul li { margin-bottom: 12px; color: var(--text-light); font-size: 0.9rem; cursor: pointer; }
        .footer-links ul li:hover { color: var(--text-main); text-decoration: underline; }

        /* --- MOBILE NAV --- */
        .mobile-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            height: var(--nav-height); background: var(--surface);
            border-top: 1px solid var(--border);
            display: flex; justify-content: space-around; align-items: center;
            z-index: 90; padding-bottom: env(safe-area-inset-bottom);
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            color: var(--text-light); border: none; background: none; flex: 1;
        }
        .nav-item.active { color: var(--primary); }
        @media (min-width: 768px) { .mobile-nav { display: none; } }

        /* --- UTILS --- */
        .badge {
            background: var(--primary); color: var(--on-primary);
            font-size: 0.7rem; padding: 2px 6px; border-radius: 99px;
            position: absolute; top: -6px; right: -6px; font-weight: bold;
        }
        .tag {
            padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; 
            text-transform: uppercase; display: inline-block;
        }
        .tag-new { background: var(--primary); color: var(--on-primary); }
        .hidden { display: none !important; }

        /* Toast */
        #toast {
            position: fixed; top: 24px; right: 24px;
            background: var(--primary); color: var(--on-primary);
            padding: 16px 24px; border-radius: 12px;
            display: flex; align-items: center; gap: 12px;
            transform: translateY(-150%); opacity: 0; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2000; box-shadow: var(--shadow-lg); font-weight: 500;
        }
        #toast.visible { transform: translateY(0); opacity: 1; }
    </style>
</head>
<body>

    <!-- Notification -->
    <div id="toast">
        <i class="ph-fill ph-info"></i> 
        <span id="toast-msg">Notificação</span>
    </div>

    <!-- Header -->
    <header>
        <div class="container header-inner">
            <div class="flex" style="display:flex; align-items:center; gap:12px; cursor: pointer;" onclick="app.router.go('home')">
                <img src="./102416.png" alt="JV Imports" class="logo-img" onerror="this.style.display='none'; document.getElementById('fallback-logo').style.display='block'">
                <div id="fallback-logo" style="display:none; font-weight:900; font-size:1.4rem; letter-spacing:-1px;">
                    JV<span style="font-weight:300;">IMPORTS</span>
                </div>
            </div>

            <nav class="desktop-nav">
                <a href="#" onclick="app.router.go('home')">Início</a>
                <a href="#" onclick="app.router.go('home', {filter:'moda'})">Moda</a>
                <a href="#" onclick="app.router.go('home', {filter:'eletronicos'})">Eletrônicos</a>
                <a href="#" onclick="app.router.go('profile')">Meus Pedidos</a>
            </nav>

            <div style="display:flex; align-items:center; gap:12px;">
                <button onclick="app.router.go('search')" class="btn-outline" style="border:none; padding:8px; border-radius:50%;">
                    <i class="ph ph-magnifying-glass" style="font-size:1.4rem;"></i>
                </button>
                <button onclick="app.router.go('cart')" style="background:none; border:none; position:relative; padding:8px; color:inherit;">
                    <i class="ph ph-shopping-bag" style="font-size:1.4rem;"></i>
                    <span id="header-badge" class="badge hidden">0</span>
                </button>
                <button onclick="app.theme.toggle()" style="background:none; border:none; padding:8px; color:inherit;">
                    <i id="theme-icon" class="ph ph-moon" style="font-size:1.4rem;"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container"></main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-links">
                <div>
                    <h4>Sobre a JV Imports</h4>
                    <p style="color:var(--text-light); font-size:0.9rem; line-height:1.6; margin-bottom:10px;">
                        Sua loja premium de importados. Trazemos o melhor da tecnologia e moda mundial diretamente para o Brasil com segurança e agilidade.
                    </p>
                    <div style="display:flex; gap:10px; margin-top:15px;">
                        <i class="ph-fill ph-instagram-logo" style="font-size:1.5rem; cursor:pointer;"></i>
                        <i class="ph-fill ph-facebook-logo" style="font-size:1.5rem; cursor:pointer;"></i>
                        <i class="ph-fill ph-whatsapp-logo" style="font-size:1.5rem; cursor:pointer;"></i>
                    </div>
                </div>
                <div>
                    <h4>Categorias</h4>
                    <ul>
                        <li onclick="app.router.go('home', {filter:'moda'})">Moda Masculina</li>
                        <li onclick="app.router.go('home', {filter:'eletronicos'})">Eletrônicos</li>
                        <li onclick="app.router.go('home', {filter:'acessorios'})">Acessórios</li>
                        <li onclick="app.router.go('home', {filter:'calcados'})">Calçados</li>
                    </ul>
                </div>
                <div>
                    <h4>Atendimento</h4>
                    <ul>
                        <li>Central de Ajuda</li>
                        <li>Acompanhar Pedido</li>
                        <li>Trocas e Devoluções</li>
                        <li>Política de Privacidade</li>
                    </ul>
                </div>
            </div>
            <div style="border-top:1px solid var(--border); padding-top:20px; text-align:center; color:var(--text-light); font-size:0.85rem;">
                &copy; 2025 JV Imports. Todos os direitos reservados.
            </div>
        </div>
    </footer>

    <!-- Mobile Nav -->
    <nav class="mobile-nav">
        <button class="nav-item active" id="nav-home" onclick="app.router.go('home')">
            <i class="ph ph-house" style="font-size:1.5rem;"></i>
            <span style="font-size:0.7rem; font-weight:500;">Início</span>
        </button>
        <button class="nav-item" id="nav-search" onclick="app.router.go('search')">
            <i class="ph ph-magnifying-glass" style="font-size:1.5rem;"></i>
            <span style="font-size:0.7rem; font-weight:500;">Buscar</span>
        </button>
        <button class="nav-item" id="nav-cart" onclick="app.router.go('cart')">
            <i class="ph ph-shopping-bag" style="font-size:1.5rem;"></i>
            <span style="font-size:0.7rem; font-weight:500;">Carrinho</span>
        </button>
        <button class="nav-item" id="nav-profile" onclick="app.router.go('profile')">
            <i class="ph ph-user" style="font-size:1.5rem;"></i>
            <span style="font-size:0.7rem; font-weight:500;">Perfil</span>
        </button>
    </nav>

<script>
    // --- CONFIG ---
    const CONFIG = {
        // Real logic placeholder
        firebase: { apiKey: "MOCK_KEY" } 
    };

    // --- DATA ---
    const DB = [
        { id: 1, title: "iPhone 15 Pro Max Titanium", price: 8999.00, cat: "eletronicos", img: "https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=600&q=90", isNew: true },
        { id: 2, title: "MacBook Air M2 Midnight", price: 7499.00, cat: "eletronicos", img: "https://images.unsplash.com/photo-1661963212519-94dd78414133?w=600&q=90", isNew: false },
        { id: 3, title: "Jaqueta Bomber Premium", price: 399.90, cat: "moda", img: "https://images.unsplash.com/photo-1551028919-ac7bcb99015b?w=600&q=90", isNew: false },
        { id: 4, title: "Nike Air Jordan 1 High", price: 1199.90, cat: "calcados", img: "https://images.unsplash.com/photo-1549298916-b41d501d3772?w=600&q=90", isNew: true },
        { id: 5, title: "Sony WH-1000XM5", price: 2200.00, cat: "acessorios", img: "https://images.unsplash.com/photo-1618366712010-f4ae9c647dcb?w=600&q=90", isNew: false },
        { id: 6, title: "Ray-Ban Wayfarer Classic", price: 650.00, cat: "acessorios", img: "https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=600&q=90", isNew: false },
        { id: 7, title: "Apple Watch Ultra 2", price: 5299.00, cat: "acessorios", img: "https://images.unsplash.com/photo-1664730022301-249761e4d248?w=600&q=90", isNew: true },
        { id: 8, title: "Perfume Bleu de Chanel", price: 850.00, cat: "moda", img: "https://images.unsplash.com/photo-1523293182086-7651a899d60f?w=600&q=90", isNew: false }
    ];

    const app = {
        state: {
            cart: JSON.parse(localStorage.getItem('jv_cart')) || [],
            userAddress: JSON.parse(localStorage.getItem('jv_address')) || { street: '', number: '', zip: '' },
            user: JSON.parse(localStorage.getItem('jv_user')) || null,
            currentView: 'home'
        },

        init: () => {
            const savedTheme = localStorage.getItem('jv_theme');
            if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
            
            app.ui.updateBadge();
            app.router.go('home');
        },

        theme: {
            toggle: () => {
                const current = document.documentElement.getAttribute('data-theme') || 'light';
                const next = current === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', next);
                localStorage.setItem('jv_theme', next);
            }
        },

        utils: {
            fmt: n => n.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }),
            toast: (msg) => {
                const t = document.getElementById('toast');
                document.getElementById('toast-msg').innerText = msg;
                t.classList.add('visible');
                setTimeout(() => t.classList.remove('visible'), 3000);
            },
            maskCard: v => v.replace(/\D/g,'').replace(/(\d{4})(\d)/g, '$1 ').trim().substr(0,19)
        },

        cart: {
            add: (id) => {
                const p = DB.find(x => x.id === id);
                const exist = app.state.cart.find(x => x.id === id);
                if(exist) exist.qty++; else app.state.cart.push({...p, qty: 1});
                app.cart.save();
                app.utils.toast("Adicionado ao carrinho!");
            },
            update: (id, d) => {
                const item = app.state.cart.find(x => x.id === id);
                if(item) {
                    item.qty += d;
                    if(item.qty <= 0) app.state.cart = app.state.cart.filter(x => x.id !== id);
                    app.cart.save();
                    app.router.render();
                }
            },
            total: () => app.state.cart.reduce((a,b) => a + (b.price * b.qty), 0),
            save: () => {
                localStorage.setItem('jv_cart', JSON.stringify(app.state.cart));
                app.ui.updateBadge();
            }
        },

        ui: {
            updateBadge: () => {
                const count = app.state.cart.reduce((a,b) => a + b.qty, 0);
                const el = document.getElementById('header-badge');
                el.innerText = count;
                count > 0 ? el.classList.remove('hidden') : el.classList.add('hidden');
            },
            setNav: (id) => {
                document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
                const el = document.getElementById('nav-'+id);
                if(el) el.classList.add('active');
                
                // Update desktop nav links
                document.querySelectorAll('.desktop-nav a').forEach(a => a.classList.remove('active'));
                if(id === 'home') document.querySelector('.desktop-nav a').classList.add('active');
            }
        },

        router: {
            go: (view, props = {}) => {
                app.state.currentView = view;
                app.state.viewProps = props;
                window.scrollTo(0,0);
                app.router.render();
                
                const map = { 'home':'home', 'cart':'cart', 'search':'search', 'profile':'profile' };
                app.ui.setNav(map[view] || 'home');
            },
            render: () => {
                const root = document.getElementById('main-content');
                root.innerHTML = app.views[app.state.currentView]();
            }
        },

        views: {
            home: () => {
                const filter = app.state.viewProps?.filter || 'all';
                const products = filter === 'all' ? DB : DB.filter(p => p.cat === filter);
                
                return `
                    ${filter === 'all' ? `
                        <div style="background:var(--secondary); border-radius:var(--radius); padding:40px 20px; text-align:center; margin-bottom:40px; border:1px solid var(--border);">
                            <h1 style="font-size:2.5rem; font-weight:800; margin-bottom:10px; letter-spacing:-1px;">Nova Coleção 2025</h1>
                            <p style="color:var(--text-light); max-width:500px; margin:0 auto 20px;">
                                As tendências mundiais chegaram. Design exclusivo e qualidade premium.
                            </p>
                            <button class="btn" onclick="app.router.go('search')">Ver Produtos</button>
                        </div>
                    ` : ''}
                    
                    <div class="flex" style="justify-content:space-between; margin-bottom:24px;">
                        <h2 style="text-transform:capitalize; font-weight:700;">${filter === 'all' ? 'Destaques' : filter}</h2>
                        ${filter !== 'all' ? `<button class="btn-sm btn-outline" onclick="app.router.go('home')">Limpar Filtro</button>` : ''}
                    </div>

                    <div class="product-grid">
                        ${products.map(p => `
                            <div class="card" style="cursor:pointer;" onclick="app.router.go('product', {id:${p.id}})">
                                <div class="card-img-wrapper">
                                    <img src="${p.img}" class="card-img">
                                    ${p.isNew ? `<span class="tag tag-new" style="position:absolute; top:10px; left:10px;">Novo</span>` : ''}
                                </div>
                                <div class="card-body">
                                    <span style="font-size:0.75rem; color:var(--text-light); text-transform:uppercase; font-weight:600;">${p.cat}</span>
                                    <h3 style="font-size:1rem; font-weight:600; line-height:1.3; flex:1;">${p.title}</h3>
                                    <div class="flex" style="justify-content:space-between; align-items:center; margin-top:8px;">
                                        <span style="font-size:1.1rem; font-weight:800;">${app.utils.fmt(p.price)}</span>
                                        <button class="btn" style="width:36px; height:36px; padding:0; border-radius:50%;" onclick="event.stopPropagation(); app.cart.add(${p.id})">
                                            <i class="ph-bold ph-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            },
            product: () => {
                const id = app.state.viewProps.id;
                const p = DB.find(x => x.id === id);
                if(!p) return app.router.go('home');
                
                return `
                    <div class="checkout-layout">
                        <div class="card" style="overflow:hidden; border:1px solid var(--border);">
                            <div style="background:var(--secondary); padding:40px; display:flex; align-items:center; justify-content:center;">
                                <img src="${p.img}" style="width:100%; max-width:400px; object-fit:contain; mix-blend-mode:multiply;">
                            </div>
                        </div>
                        <div>
                            <button onclick="app.router.go('home')" style="margin-bottom:20px; background:none; border:none; display:flex; align-items:center; gap:6px; color:var(--text-light); font-weight:500;">
                                <i class="ph-bold ph-arrow-left"></i> Voltar
                            </button>
                            <span class="tag tag-new" style="margin-bottom:12px;">Em Estoque</span>
                            <h1 style="font-size:2rem; font-weight:800; line-height:1.1; margin-bottom:12px;">${p.title}</h1>
                            <h2 style="font-size:2rem; font-weight:300; margin-bottom:24px;">${app.utils.fmt(p.price)}</h2>
                            
                            <div class="card" style="padding:24px; margin-bottom:24px; background:var(--surface);">
                                <h4 style="margin-bottom:10px; font-weight:600;">Sobre o produto</h4>
                                <p style="color:var(--text-light); line-height:1.6;">
                                    Produto original com garantia internacional. Acabamento premium, durabilidade excepcional e design exclusivo da marca.
                                    Disponível para pronta entrega.
                                </p>
                            </div>

                            <button class="btn" style="width:100%; padding:16px; font-size:1rem;" onclick="app.cart.add(${p.id})">
                                ADICIONAR AO CARRINHO
                            </button>
                        </div>
                    </div>
                `;
            },
            cart: () => {
                if(app.state.cart.length === 0) return `
                    <div style="text-align:center; padding:80px 20px;">
                        <i class="ph-duotone ph-shopping-cart" style="font-size:4rem; color:var(--text-light); opacity:0.5; margin-bottom:20px;"></i>
                        <h2 style="margin-bottom:10px;">Carrinho Vazio</h2>
                        <p style="color:var(--text-light); margin-bottom:30px;">Parece que você ainda não escolheu nada.</p>
                        <button class="btn btn-outline" onclick="app.router.go('home')">Começar a Comprar</button>
                    </div>
                `;
                
                return `
                    <h2 style="margin-bottom:24px; font-weight:700;">Seu Carrinho</h2>
                    <div class="checkout-layout">
                        <div style="display:flex; flex-direction:column; gap:16px;">
                            ${app.state.cart.map(i => `
                                <div class="card" style="display:flex; padding:16px; gap:16px; align-items:center;">
                                    <img src="${i.img}" style="width:80px; height:80px; object-fit:cover; border-radius:8px; background:var(--secondary);">
                                    <div style="flex:1;">
                                        <div class="flex" style="justify-content:space-between; margin-bottom:4px;">
                                            <h4 style="font-weight:600; font-size:0.95rem;">${i.title}</h4>
                                            <button onclick="app.cart.update(${i.id}, -${i.qty})" style="color:var(--accent-error); border:none; background:none;"><i class="ph-bold ph-trash"></i></button>
                                        </div>
                                        <div style="color:var(--text-light); font-size:0.85rem; margin-bottom:12px;">${app.utils.fmt(i.price)} un.</div>
                                        <div class="flex" style="justify-content:space-between; align-items:center;">
                                            <div style="display:flex; align-items:center; border:1px solid var(--border); border-radius:6px; height:32px;">
                                                <button onclick="app.cart.update(${i.id}, -1)" style="padding:0 10px; height:100%; border:none; background:none;">-</button>
                                                <span style="padding:0 10px; font-weight:600; font-size:0.9rem; border-left:1px solid var(--border); border-right:1px solid var(--border); line-height:30px;">${i.qty}</span>
                                                <button onclick="app.cart.update(${i.id}, 1)" style="padding:0 10px; height:100%; border:none; background:none;">+</button>
                                            </div>
                                            <span style="font-weight:700; font-size:1rem;">${app.utils.fmt(i.price * i.qty)}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="card" style="padding:24px; height:fit-content; position:sticky; top:90px;">
                            <h3 style="font-size:1.1rem; font-weight:700; margin-bottom:20px;">Resumo</h3>
                            <div class="flex" style="justify-content:space-between; margin-bottom:12px; color:var(--text-light);">
                                <span>Subtotal</span>
                                <span>${app.utils.fmt(app.cart.total())}</span>
                            </div>
                            <div class="flex" style="justify-content:space-between; margin-bottom:24px; color:var(--accent-success);">
                                <span>Frete</span>
                                <span>Grátis</span>
                            </div>
                            <div style="border-top:1px solid var(--border); padding-top:20px; margin-bottom:24px;">
                                <div class="flex" style="justify-content:space-between; font-size:1.2rem; font-weight:800;">
                                    <span>Total</span>
                                    <span>${app.utils.fmt(app.cart.total())}</span>
                                </div>
                            </div>
                            <button class="btn" style="width:100%;" onclick="app.router.go('checkout')">Finalizar Compra</button>
                        </div>
                    </div>
                `;
            },
            checkout: () => {
                if(!app.state.user) return app.router.go('auth', {redirect:'checkout'});
                
                return `
                    <div class="checkout-layout">
                        <div>
                            <div class="card" style="padding:24px; margin-bottom:24px;">
                                <h3 style="margin-bottom:20px; font-weight:700;">Endereço</h3>
                                <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                                    <div style="grid-column:span 2">
                                        <label class="form-label">Rua</label>
                                        <input type="text" class="form-input" id="addr-street" placeholder="Rua Exemplo" value="${app.state.userAddress.street}">
                                    </div>
                                    <div>
                                        <label class="form-label">Número</label>
                                        <input type="text" class="form-input" id="addr-num" placeholder="123" value="${app.state.userAddress.number}">
                                    </div>
                                    <div>
                                        <label class="form-label">CEP</label>
                                        <input type="tel" class="form-input" id="addr-zip" placeholder="00000-000" value="${app.state.userAddress.zip}">
                                    </div>
                                </div>
                            </div>

                            <div class="card" style="padding:24px;">
                                <h3 style="margin-bottom:20px; font-weight:700;">Pagamento</h3>
                                <div style="display:flex; gap:12px; margin-bottom:24px;">
                                    <button class="btn btn-outline" style="flex:1;" onclick="document.getElementById('card-form').classList.add('hidden')">PIX (-5%)</button>
                                    <button class="btn btn-outline" style="flex:1;" onclick="document.getElementById('card-form').classList.remove('hidden')">Cartão</button>
                                </div>
                                
                                <div id="card-form" class="hidden" style="background:var(--secondary); padding:20px; border-radius:8px; border:1px solid var(--border);">
                                    <div style="margin-bottom:16px;">
                                        <label class="form-label">Número do Cartão</label>
                                        <input type="tel" class="form-input" placeholder="0000 0000 0000 0000" oninput="this.value=app.utils.maskCard(this.value)">
                                    </div>
                                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                                        <div>
                                            <label class="form-label">Validade</label>
                                            <input type="tel" class="form-input" placeholder="MM/AA">
                                        </div>
                                        <div>
                                            <label class="form-label">CVV</label>
                                            <input type="tel" class="form-input" placeholder="123">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="padding:24px; height:fit-content;">
                            <h3 style="margin-bottom:20px; font-weight:700;">Confirmar</h3>
                             <div class="flex" style="justify-content:space-between; font-size:1.2rem; font-weight:800; margin-bottom:24px;">
                                <span>Total</span>
                                <span>${app.utils.fmt(app.cart.total())}</span>
                            </div>
                            <button class="btn" style="width:100%;" onclick="app.state.cart=[]; app.cart.save(); app.router.go('success')">
                                Pagar Agora
                            </button>
                        </div>
                    </div>
                `;
            },
            auth: () => {
                const isReg = app.state.viewProps?.mode === 'register';
                return `
                    <div class="container" style="max-width:420px; padding-top:40px;">
                        <div class="card" style="padding:32px;">
                            <h2 style="text-align:center; margin-bottom:24px; font-weight:800;">${isReg ? 'Criar Conta' : 'Acessar Conta'}</h2>
                            
                            <div style="margin-bottom:16px;">
                                <label class="form-label">E-mail</label>
                                <input type="email" id="auth-email" class="form-input">
                            </div>
                            <div style="margin-bottom:24px;">
                                <label class="form-label">Senha</label>
                                <input type="password" id="auth-pass" class="form-input">
                            </div>
                            
                            <button class="btn" style="width:100%; margin-bottom:16px;" onclick="app.handlers.auth('${isReg?'register':'login'}')">
                                ${isReg ? 'Cadastrar' : 'Entrar'}
                            </button>

                            <p style="text-align:center; font-size:0.9rem; color:var(--text-light);">
                                ${isReg ? 'Já possui conta?' : 'Não tem conta?'} 
                                <span style="color:var(--text-main); font-weight:700; cursor:pointer; text-decoration:underline;" 
                                      onclick="app.router.go('auth', {mode:'${isReg?'login':'register'}'})">
                                    ${isReg ? 'Fazer Login' : 'Cadastre-se'}
                                </span>
                            </p>
                        </div>
                    </div>
                `;
            },
            profile: () => {
                if(!app.state.user) return app.router.go('auth');
                return `
                    <div class="checkout-layout">
                        <div class="card" style="padding:24px; display:flex; align-items:center; justify-content:space-between;">
                            <div>
                                <h2 style="font-weight:700;">${app.state.user.email.split('@')[0]}</h2>
                                <p style="color:var(--text-light);">${app.state.user.email}</p>
                            </div>
                            <button class="btn-outline btn-sm" onclick="localStorage.removeItem('jv_user'); app.state.user=null; app.router.go('home')">
                                Sair
                            </button>
                        </div>
                        <div class="card" style="padding:40px; text-align:center;">
                            <p style="color:var(--text-light);">Você ainda não tem pedidos recentes.</p>
                        </div>
                    </div>
                `;
            },
            search: () => `
                <div class="container" style="max-width:600px;">
                    <input type="text" class="form-input" placeholder="O que você procura?" autofocus 
                           style="padding:16px; font-size:1.1rem;"
                           oninput="app.handlers.search(this.value)">
                    <div id="search-results" style="margin-top:20px;"></div>
                </div>
            `,
            success: () => `
                <div class="container" style="max-width:500px; text-align:center; padding-top:60px;">
                    <div style="width:80px; height:80px; background:var(--accent-success); color:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 24px;">
                        <i class="ph-bold ph-check" style="font-size:2.5rem;"></i>
                    </div>
                    <h1 style="margin-bottom:16px; font-weight:800;">Pedido Confirmado!</h1>
                    <p style="color:var(--text-light); line-height:1.6; margin-bottom:32px;">
                        Obrigado pela compra. Enviamos os detalhes para o seu e-mail.
                    </p>
                    <button class="btn" onclick="app.router.go('home')">Voltar para a Loja</button>
                </div>
            `
        },

        handlers: {
            search: (val) => {
                const res = val ? DB.filter(p => p.title.toLowerCase().includes(val.toLowerCase())) : [];
                document.getElementById('search-results').innerHTML = res.map(p => `
                    <div onclick="app.router.go('product', {id:${p.id}})" class="card" style="display:flex; gap:16px; padding:12px; margin-bottom:12px; cursor:pointer; align-items:center;">
                        <img src="${p.img}" style="width:50px; height:50px; object-fit:cover; border-radius:6px;">
                        <div>
                            <div style="font-weight:600;">${p.title}</div>
                            <div style="color:var(--text-light); font-size:0.9rem;">${app.utils.fmt(p.price)}</div>
                        </div>
                    </div>
                `).join('');
            },
            auth: (mode) => {
                const email = document.getElementById('auth-email').value;
                if(!email) return app.utils.toast("Preencha o e-mail");
                app.state.user = { email };
                localStorage.setItem('jv_user', JSON.stringify(app.state.user));
                app.router.go(app.state.viewProps?.redirect || 'profile');
            }
        }
    };

    document.addEventListener('DOMContentLoaded', app.init);
</script>
</body>
</html>